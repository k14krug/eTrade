{% extends "base.html" %}

{% block title %}S&P 500 Stocks{% endblock %}

{% block content %}
<h1 class="mb-4">S&P 500 Stocks</h1>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>
                <a href="{{ url_for('sp500.sp500', sort_by='symbol', sort_order='asc' if sort_by != 'symbol' or sort_order == 'desc' else 'desc') }}">
                    Symbol
                    {% if sort_by == 'symbol' %}
                        <i class="bi bi-arrow-{{ 'up' if sort_order == 'asc' else 'down' }}"></i>
                    {% endif %}
                </a>
            </th>
            <th>
                <a href="{{ url_for('sp500.sp500', sort_by='current_price', sort_order='asc' if sort_by != 'current_price' or sort_order == 'desc' else 'desc') }}">
                    Current Price
                    {% if sort_by == 'current_price' %}
                        <i class="bi bi-arrow-{{ 'up' if sort_order == 'asc' else 'down' }}"></i>
                    {% endif %}
                </a>
            </th>
            <th>
                <a href="{{ url_for('sp500.sp500', sort_by='previous_price', sort_order='asc' if sort_by != 'previous_price' or sort_order == 'desc' else 'desc') }}">
                    Previous Price
                    {% if sort_by == 'previous_price' %}
                        <i class="bi bi-arrow-{{ 'up' if sort_order == 'asc' else 'down' }}"></i>
                    {% endif %}
                </a>
            </th>
            <th>
                <a href="{{ url_for('sp500.sp500', sort_by='gain_loss', sort_order='asc' if sort_by != 'gain_loss' or sort_order == 'desc' else 'desc') }}">
                    Gain/Loss
                    {% if sort_by == 'gain_loss' %}
                        <i class="bi bi-arrow-{{ 'up' if sort_order == 'asc' else 'down' }}"></i>
                    {% endif %}
                </a>
            </th>
            <th>
                <a href="{{ url_for('sp500.sp500', sort_by='gain_loss_percentage', sort_order='asc' if sort_by != 'gain_loss_percentage' or sort_order == 'desc' else 'desc') }}">
                    Gain/Loss %
                    {% if sort_by == 'gain_loss_percentage' %}
                        <i class="bi bi-arrow-{{ 'up' if sort_order == 'asc' else 'down' }}"></i>
                    {% endif %}
                </a>
            </th>
        </tr>
    </thead>
    <tbody>
        {% for stock in data %}
        <tr>
            <td>
                <a href="https://finance.yahoo.com/quote/{{ stock.symbol }}" target="_blank" rel="noopener noreferrer">
                    {{ stock.symbol }}
                </a>
            </td>
            <td>${{ stock.current_price }}</td>
            <td>${{ stock.previous_price }}</td>
            <td class="{{ 'text-success' if stock.gain_loss > 0 else 'text-danger' }}">
                ${{ stock.gain_loss }}
            </td>
            <td class="{{ 'text-success' if stock.gain_loss_percentage > 0 else 'text-danger' }}">
                {{ stock.gain_loss_percentage }}%
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
        {% for p in range(1, total_pages + 1) %}
        <li class="page-item {{ 'active' if p == page else '' }}">
            <a class="page-link" href="{{ url_for('sp500.sp500', page=p, sort_by=sort_by, sort_order=sort_order) }}">{{ p }}</a>
        </li>
        {% endfor %}
    </ul>
</nav>
{% endblock %}

{% block styles %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
{% endblock %}